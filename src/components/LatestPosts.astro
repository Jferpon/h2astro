---
import { Image } from 'astro:assets';
import { getCollection } from 'astro:content';
import FormattedDate from './FormattedDate.astro';

const posts = (await getCollection('blog'))
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 3);
---

<style>
	.latest-posts {
		display: grid;
		grid-template-columns: repeat(3, 1fr); /* Siempre 3 en l√≠nea */
		gap: 2rem;
		list-style: none;
		padding: 0;
		margin: 2rem 0;
	}

	.latest-posts li {
		display: flex;
		flex-direction: column;
		height: 100%; /* Para que el li ocupe toda la altura posible */
	}

	.latest-posts a {
		display: flex;
		flex-direction: column;
		flex: 1; /* Hace que el contenido ocupe todo el li */
		text-decoration: none;
	}

	.latest-posts img {
		width: 100%;
		height: 200px;
		object-fit: cover;
		border-radius: 12px;
		margin-bottom: 0.75rem;
	}

	.title {
		margin: 0;
		color: rgb(var(--black));
		font-size: 1.1rem;
		font-weight: 600;
	}

	.date {
		margin-top: 0.25rem;
		color: rgb(var(--gray));
		font-size: 0.85rem;
	}

	.description {
		margin-top: 0.5rem;
		color: #555; 
		font-size: 1rem; 
		line-height: 1.3;
		flex-grow: 1; 
	}

	.latest-posts a:hover .title {
		color: rgb(var(--accent));
	}
</style>

<ul class="latest-posts">
	{posts.map((post) => (
		<li>
			<a href={`/blog/${post.id}/`}>
				{post.data.heroImage && (
					<Image src={post.data.heroImage} alt={post.data.title} />
				)}
				<h4 class="title">{post.data.title}</h4>
				<p class="date">
					<FormattedDate date={post.data.pubDate} />
				</p>
				{post.data.description && (
					<p class="description">{post.data.description}</p>
				)}
			</a>
		</li>
	))}
</ul>
